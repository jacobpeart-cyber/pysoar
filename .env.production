# PySOAR Production Configuration
# This file contains recommended production settings
# Copy to .env and customize for your environment

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

APP_NAME=PySOAR
APP_ENV=production
DEBUG=false

# IMPORTANT: Generate strong random secrets for production!
# Use: python -c "import secrets; print(secrets.token_urlsafe(64))"
SECRET_KEY=CHANGE_ME_TO_A_STRONG_RANDOM_SECRET_KEY
JWT_SECRET_KEY=CHANGE_ME_TO_ANOTHER_STRONG_RANDOM_SECRET_KEY

API_V1_PREFIX=/api/v1

# =============================================================================
# SERVER SETTINGS
# =============================================================================

HOST=0.0.0.0
PORT=8000
# Set workers based on CPU cores: (2 * cores) + 1
WORKERS=4

# =============================================================================
# DATABASE
# =============================================================================

# PostgreSQL is recommended for production
# Format: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://pysoar:your_secure_password@db:5432/pysoar

# Connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30

# =============================================================================
# REDIS (for caching and task queue)
# =============================================================================

REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2

# =============================================================================
# AUTHENTICATION
# =============================================================================

JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# IMPORTANT: Change default admin credentials immediately after first login
FIRST_ADMIN_EMAIL=admin@yourdomain.com
FIRST_ADMIN_PASSWORD=CHANGE_THIS_IMMEDIATELY

# =============================================================================
# CORS (Update with your actual frontend domain)
# =============================================================================

CORS_ORIGINS=["https://pysoar.yourdomain.com"]

# =============================================================================
# LOGGING
# =============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# SECURITY
# =============================================================================

# Rate limiting
RATE_LIMIT_PER_MINUTE=60

# Session settings
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax

# HTTPS settings (when behind reverse proxy)
FORWARDED_ALLOW_IPS=*
PROXY_HEADERS=true

# =============================================================================
# FILE UPLOADS
# =============================================================================

UPLOAD_DIR=/app/uploads
MAX_FILE_SIZE=52428800  # 50MB in bytes

# =============================================================================
# EMAIL (SMTP)
# =============================================================================

SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=your_smtp_password
SMTP_FROM=noreply@yourdomain.com
SMTP_TLS=true

# =============================================================================
# INTEGRATIONS - Threat Intelligence
# =============================================================================

# VirusTotal (https://www.virustotal.com/gui/join-us)
VIRUSTOTAL_API_KEY=

# AbuseIPDB (https://www.abuseipdb.com/account/api)
ABUSEIPDB_API_KEY=

# Shodan (https://account.shodan.io/)
SHODAN_API_KEY=

# GreyNoise (https://viz.greynoise.io/signup)
GREYNOISE_API_KEY=

# MISP (your MISP instance)
MISP_URL=
MISP_API_KEY=
MISP_VERIFY_SSL=true

# =============================================================================
# INTEGRATIONS - Notifications
# =============================================================================

# Slack
SLACK_WEBHOOK_URL=

# PagerDuty
PAGERDUTY_API_KEY=
PAGERDUTY_SERVICE_ID=

# Microsoft Teams
TEAMS_WEBHOOK_URL=

# =============================================================================
# INTEGRATIONS - SIEM
# =============================================================================

# Elasticsearch
ELASTICSEARCH_URL=
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
ELASTICSEARCH_INDEX_PREFIX=pysoar-

# Splunk
SPLUNK_HOST=
SPLUNK_HEC_TOKEN=
SPLUNK_INDEX=main

# =============================================================================
# INTEGRATIONS - Analysis
# =============================================================================

# Cortex
CORTEX_URL=
CORTEX_API_KEY=

# =============================================================================
# MONITORING (Optional)
# =============================================================================

# Sentry for error tracking
SENTRY_DSN=

# Prometheus metrics endpoint
METRICS_ENABLED=true
METRICS_PATH=/metrics
